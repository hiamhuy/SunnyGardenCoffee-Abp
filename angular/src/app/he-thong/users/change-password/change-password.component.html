<div [@routerTransition]>
  <section class="content-header">
    <div class="container-fluid">
      <div class="row">
        <div class="col-6">
          <h1>Thay đổi mật khẩu</h1>
        </div>
      </div>
    </div>
  </section>
  <section class="content px-2">
    <div class="container-fluid">
      <div class="card">
        <form
          class="form-horizontal"
          autocomplete="off"
          #changePasswordForm="ngForm"
          (ngSubmit)="changePassword()"
        >
          <div class="card-body">
            <div class="modal-body">
              <div class="form-group row required">
                <label class="col-md-3 col-form-label" for="currentPassword">
                  Nhập mật khẩu cũ
                </label>
                <div>
                  <nz-input-group [nzSuffix]="suffixTemplate">
                    <input
                      [type]="OldPasswordVisible ? 'text' : 'password'"
                      nz-input
                      name="currentPassword"
                      id="currentPassword"
                      required
                      minlength="2"
                      maxlength="32"
                      [(ngModel)]="changePasswordDto.currentPassword"
                      #currentPasswordModel="ngModel"
                      #currentPasswordEl
                    />
                  </nz-input-group>
                  <ng-template #suffixTemplate>
                    <span (click)="OldPasswordVisible = !OldPasswordVisible"
                      ><i
                        class="far {{
                          OldPasswordVisible ? 'fa-eye-slash' : 'fa-eye'
                        }} "
                      ></i>
                    </span>
                  </ng-template>

                  <abp-validation-summary
                    [control]="currentPasswordModel"
                    [controlEl]="currentPasswordEl"
                  ></abp-validation-summary>
                </div>
              </div>
              <div class="form-group row required">
                <label class="col-md-3 col-form-label" for="newPassword">
                  Nhập mật khẩu mới
                </label>
                <div>
                  <nz-input-group [nzSuffix]="suffixTemplate1">
                    <input
                      [type]="NewPasswordVisible ? 'text' : 'password'"
                      nz-input
                      name="newPassword"
                      id="newPassword"
                      required
                      minlength="2"
                      maxlength="32"
                      validateEqual="confirmNewPassword"
                      reverse="true"
                      pattern="(?=^.{8,}$)(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?!.*\s)[0-9a-zA-Z!@#$%^&*()]*$"
                      [(ngModel)]="changePasswordDto.newPassword"
                      #newPasswordModel="ngModel"
                      #newPasswordEl
                    />
                  </nz-input-group>
                  <ng-template #suffixTemplate1>
                    <span (click)="NewPasswordVisible = !NewPasswordVisible"
                      ><i
                        class="far {{
                          NewPasswordVisible ? 'fa-eye-slash' : 'fa-eye'
                        }} "
                      ></i>
                    </span>
                  </ng-template>

                  <abp-validation-summary
                    [control]="newPasswordModel"
                    [controlEl]="newPasswordEl"
                    [customValidationErrors]="newPasswordValidationErrors"
                  ></abp-validation-summary>
                </div>
              </div>
              <div class="form-group row required">
                <label class="col-md-3 col-form-label" for="confirmNewPassword">
                  Nhập lại mật khẩu mới
                </label>
                <div>
                  <nz-input-group [nzSuffix]="suffixTemplate2">
                    <input
                      nz-input
                      [type]="ReNewPasswordVisible ? 'text' : 'password'"
                      name="confirmNewPassword"
                      id="confirmNewPassword"
                      required
                      minlength="2"
                      maxlength="32"
                      validateEqual="newPassword"
                      reverse="false"
                      ngModel
                      #confirmNewPasswordModel="ngModel"
                      #confirmNewPasswordEl
                    />
                  </nz-input-group>
                  <ng-template #suffixTemplate2>
                    <span (click)="ReNewPasswordVisible = !ReNewPasswordVisible"
                      ><i
                        class="far {{
                          ReNewPasswordVisible ? 'fa-eye-slash' : 'fa-eye'
                        }} "
                      ></i>
                    </span>
                  </ng-template>

                  <abp-validation-summary
                    [control]="confirmNewPasswordModel"
                    [controlEl]="confirmNewPasswordEl"
                    [customValidationErrors]="
                      confirmNewPasswordValidationErrors
                    "
                  ></abp-validation-summary>
                </div>
              </div>
            </div>
          </div>
          <div class="card-footer d-flex justify-content-end">
            <button
              nz-button
              nzType="primary"
              [disabled]="!changePasswordForm.form.valid || saving"
              (click)="changePassword()"
            >
              Lưu
            </button>
            <button class="ml-3" nz-button nzType="default" (click)="back()">
              Hủy
            </button>
          </div>
        </form>
      </div>
    </div>
  </section>
</div>
